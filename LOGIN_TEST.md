# 登录功能测试说明

## 问题修复
**重要修复**：之前存在两个严重问题，现在都已修复：

1. ✅ **接口分离**：不同角色调用不同的登录接口
   - **管理员登录** → 调用 `/admin/login` 接口
   - **机构登录** → 调用 `/ins/login` 接口  
   - **用户登录** → 调用 `/user/login` 接口

2. ✅ **页面跳转分离**：不同角色登录后跳转到不同的页面
   - **管理员登录** → 跳转到 `/admin` (管理员仪表板)
   - **机构登录** → 跳转到 `/organization` (机构仪表板)
   - **用户登录** → 跳转到 `/user` (用户仪表板)

## 后端接口配置

- **后端地址**: `http://localhost:8080`
- **管理员登录**: `POST /admin/login`
- **机构登录**: `POST /ins/login`
- **用户登录**: `POST /user/login`
- **用户注册**: `POST /user/register`
- **登出接口**: `POST /user/logout`

## 请求数据格式

### 管理员登录请求
```json
{
  "username": "admin",
  "password": "admin"
}
```

### 机构登录请求
```json
{
  "username": "org",
  "password": "123456"
}
```

### 用户登录请求
```json
{
  "username": "user",
  "password": "123456"
}
```

## 期望的后端响应格式

### 成功响应
```json
{
  "code": 1,
  "data": {
    "id": 1,
    "username": "用户名",
    "name": "真实姓名",
    "token": "jwt-token"
  },
  "message": "登录成功"
}
```

### 失败响应
```json
{
  "code": 0,
  "message": "用户名或密码错误"
}
```

## 测试账号

### 管理员账号
- 用户名：`admin`
- 密码：`admin`
- 角色：管理员
- 接口：`/admin/login`

### 普通用户账号
- 用户名：`user`
- 密码：`123456`
- 角色：普通用户
- 接口：`/user/login`

### 帮扶机构账号
- 用户名：`org`
- 密码：`123456`
- 角色：帮扶机构
- 接口：`/ins/login`

## 测试步骤

1. **启动后端服务器**
   ```bash
   # 确保后端服务器在 localhost:8080 运行
   ```

2. **启动前端开发服务器**
   ```bash
   npm run dev
   ```

3. **访问登录页面**
   - 打开浏览器访问 `http://localhost:5173/login`

4. **测试不同角色登录**
   - 选择"管理员"角色，使用管理员账号登录
   - 选择"帮扶机构"角色，使用机构账号登录
   - 选择"普通用户"角色，使用用户账号登录

5. **验证登录结果**
   - 检查控制台输出，确认调用了正确的接口
   - 验证页面跳转到正确的页面
   - 检查本地存储中的用户信息

## 控制台输出示例

### 管理员登录
```
发送登录请求到后端: {username: "admin", password: "admin", role: "admin"}
管理员登录，调用接口: http://localhost:8080/admin/login
后端响应: {code: 1, data: {...}, message: "登录成功"}
登录成功！用户信息: {...}
Token: jwt-token-1234567890
管理员登录成功，跳转到管理员仪表板
准备跳转到: /admin
```

### 机构登录
```
发送登录请求到后端: {username: "org", password: "123456", role: "organization"}
机构登录，调用接口: http://localhost:8080/ins/login
后端响应: {code: 1, data: {...}, message: "登录成功"}
登录成功！用户信息: {...}
Token: jwt-token-1234567890
机构登录成功，跳转到机构仪表板
准备跳转到: /organization
```

### 用户登录
```
发送登录请求到后端: {username: "user", password: "123456", role: "user"}
用户登录，调用接口: http://localhost:8080/user/login
后端响应: {code: 1, data: {...}, message: "登录成功"}
登录成功！用户信息: {...}
Token: jwt-token-1234567890
用户登录成功，跳转到用户仪表板
准备跳转到: /user
```

## 错误处理

### 网络连接错误
- 错误信息：`无法连接到后端服务器，请检查服务器是否启动`
- 解决方案：确保后端服务器正在运行

### 认证错误
- 错误信息：`用户名或密码错误`
- 解决方案：检查用户名和密码是否正确

### 接口错误
- 错误信息：显示后端返回的具体错误信息
- 解决方案：根据错误信息进行相应处理

## 注意事项

1. **角色权限**：确保不同角色只能访问对应的功能页面
2. **Token管理**：登录成功后正确保存和使用JWT token
3. **错误处理**：提供友好的错误提示信息
4. **安全性**：确保密码等敏感信息的安全传输

## 故障排除

### 常见问题
1. **登录失败**：检查后端服务器是否启动
2. **接口调用错误**：确认选择了正确的角色
3. **页面跳转问题**：检查路由配置是否正确

### 调试信息
- 所有API调用都会在控制台输出详细信息
- 可以通过浏览器开发者工具查看网络请求
- 检查本地存储中的用户信息是否正确保存

## 登录流程说明

### 管理员登录流程
1. 选择"管理员"角色
2. 输入管理员账号密码
3. 调用 `/admin/login` 接口
4. 登录成功后跳转到 `/admin` 页面
5. 显示管理员专用功能

### 机构登录流程
1. 选择"帮扶机构"角色
2. 输入机构账号密码
3. 调用 `/ins/login` 接口
4. 登录成功后跳转到 `/organization` 页面
5. 显示机构管理功能

### 用户登录流程
1. 选择"普通用户"角色
2. 输入用户账号密码
3. 调用 `/user/login` 接口
4. 登录成功后跳转到 `/user` 页面
5. 显示用户个人中心 