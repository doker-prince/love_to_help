# API连接测试指南

## 概述
这个测试页面用于验证前端应用与后端API的连接是否正常，以及登录功能是否正常工作。

## 访问方式
1. 启动前端开发服务器：`npm run dev`
2. 在浏览器中访问：`http://localhost:5173/api-test`

## 测试步骤

### 1. 基本连接测试
- 确保后端服务器正在运行（默认地址：`http://localhost:8080`）
- 在测试页面中填写：
  - 后端地址：`http://localhost:8080`
  - 用户名：`admin`（或您已知的用户名）
  - 密码：`admin`（或对应的密码）
  - 角色：选择对应的用户角色

### 2. 点击"测试API连接"按钮
系统将：
- 发送POST请求到 `/user/login`
- 显示详细的请求和响应信息
- 在控制台输出调试信息

### 3. 查看结果
- **成功情况**：显示"API连接成功！登录测试通过"
- **失败情况**：显示具体的错误信息

## 常见错误及解决方案

### 1. 连接被拒绝 (ECONNREFUSED)
**错误信息**：无法连接到后端服务器，请检查服务器是否启动

**解决方案**：
- 确认后端服务器是否正在运行
- 检查后端服务器端口是否正确（默认8080）
- 确认防火墙设置

### 2. 接口不存在 (404)
**错误信息**：接口不存在，请检查API路径是否正确

**解决方案**：
- 检查后端API路径是否为 `/user/login`
- 确认后端路由配置是否正确

### 3. 认证失败
**错误信息**：API连接成功，但登录失败

**解决方案**：
- 检查用户名和密码是否正确
- 确认用户角色是否匹配
- 查看后端日志获取详细错误信息

## 调试信息

### 控制台输出
测试过程中会在浏览器控制台显示：
```
开始测试API连接...
后端地址: http://localhost:8080
发送登录请求: {username: "admin", password: "admin", role: "admin"}
收到响应: {success: true, data: {...}}
```

### 响应数据
页面会显示完整的API响应数据，包括：
- 成功响应：用户信息、token等
- 错误响应：错误代码、错误消息等

## 测试不同角色

### 管理员登录
- 用户名：`admin`
- 密码：`admin`
- 角色：`admin`

### 普通用户登录
- 用户名：`user`
- 密码：`password`
- 角色：`user`

### 机构登录
- 用户名：`org`
- 密码：`password`
- 角色：`organization`

## 注意事项

1. **CORS设置**：确保后端已正确配置CORS，允许前端域名访问
2. **网络环境**：确保前后端在同一网络环境中，或正确配置代理
3. **数据格式**：确保请求和响应数据格式符合API规范
4. **安全考虑**：测试完成后建议删除或禁用此测试页面

## 下一步

如果API连接测试成功，您可以：
1. 使用正常的登录页面进行登录
2. 测试其他功能模块
3. 开始正常的应用使用流程 