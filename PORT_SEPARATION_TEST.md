# 端口分离功能测试指南

## 问题修复

已修复端口分离功能，现在两个服务会打开不同的页面：

### 🏢 管理员后台 (端口 3001)
- **启动命令**: `npm run dev:admin`
- **访问地址**: `http://localhost:3001`
- **自动打开**: `http://localhost:3001/admin-login` (管理员登录页面)
- **适用角色**: 系统管理员

### 👥 用户前台 (端口 3000)
- **启动命令**: `npm run dev:user`
- **访问地址**: `http://localhost:3000`
- **自动打开**: `http://localhost:3000/` (用户首页)
- **适用角色**: 普通用户、慈善机构

## 测试步骤

### 1. 启动管理员后台
```bash
npm run dev:admin
```

**预期结果**：
- 服务启动在端口 3001
- 浏览器自动打开 `http://localhost:3001/admin-login`
- 显示管理员登录页面

### 2. 启动用户前台
```bash
npm run dev:user
```

**预期结果**：
- 服务启动在端口 3000
- 浏览器自动打开 `http://localhost:3000/`
- 显示用户首页

### 3. 同时运行两个服务

打开两个终端窗口：

**终端1 - 管理员后台**：
```bash
npm run dev:admin
```

**终端2 - 用户前台**：
```bash
npm run dev:user
```

**预期结果**：
- 两个服务同时运行
- 管理员后台：`http://localhost:3001/admin-login`
- 用户前台：`http://localhost:3000/`

## 配置文件说明

### 管理员配置文件 (`vite.admin.config.ts`)
```typescript
server: {
    port: 3001,
    open: '/admin-login', // 直接打开管理员登录页面
    // ...
}
```

### 用户配置文件 (`vite.config.ts`)
```typescript
server: {
    port: 3000,
    open: '/', // 直接打开用户首页
    // ...
}
```

## 验证要点

### 1. 端口分离
- 管理员后台：端口 3001
- 用户前台：端口 3000
- 两个服务可以同时运行

### 2. 页面分离
- 管理员后台：自动打开管理员登录页面
- 用户前台：自动打开用户首页
- 不同的入口页面

### 3. 功能分离
- 管理员登录：`http://localhost:3001/admin-login`
- 用户登录：`http://localhost:3000/login`
- 完全独立的登录流程

### 4. 数据分离
- 管理员信息：`adminToken` 和 `adminInfo`
- 用户信息：`token` 和 `userInfo`
- 独立的存储空间

## 测试用例

### 用例1：管理员后台启动
1. 运行 `npm run dev:admin`
2. 检查端口：`http://localhost:3001`
3. 检查页面：管理员登录页面
4. 测试登录功能

### 用例2：用户前台启动
1. 运行 `npm run dev:user`
2. 检查端口：`http://localhost:3000`
3. 检查页面：用户首页
4. 测试用户功能

### 用例3：同时运行
1. 同时启动两个服务
2. 验证两个端口都能访问
3. 验证页面内容不同
4. 测试登录功能

### 用例4：端口冲突
1. 先启动一个服务
2. 再启动另一个服务
3. 检查是否有端口冲突
4. 验证两个服务都正常运行

## 故障排除

### 1. 端口被占用
```bash
# 查看端口占用
netstat -ano | findstr :3000
netstat -ano | findstr :3001

# 结束进程
taskkill /PID <进程ID> /F
```

### 2. 服务启动失败
- 检查Node.js和npm版本
- 重新安装依赖：`npm install`
- 清除缓存：`npm cache clean --force`

### 3. 页面打开错误
- 检查配置文件中的 `open` 设置
- 确认路由配置正确
- 检查浏览器控制台错误

### 4. 功能异常
- 确认后端服务器运行在 `http://localhost:8080`
- 检查API代理配置
- 验证路由守卫逻辑

## 预期行为

### 管理员后台 (端口 3001)
- ✅ 启动时自动打开管理员登录页面
- ✅ 登录成功后跳转到管理后台
- ✅ 无法访问普通用户页面
- ✅ 退出登录跳转到管理员登录页面

### 用户前台 (端口 3000)
- ✅ 启动时自动打开用户首页
- ✅ 登录成功后跳转到用户中心
- ✅ 无法访问管理员页面
- ✅ 退出登录跳转到用户登录页面

## 更新日志

### v2.2.0 (当前版本)
- ✅ 修复端口分离功能
- ✅ 配置不同的默认打开页面
- ✅ 管理员后台直接打开登录页面
- ✅ 用户前台直接打开首页
- ✅ 完善测试指南

---

**童伴桥系统 - 端口分离架构**
*真正的角色分离，更好的用户体验* 